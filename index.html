<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Moving Schedule</title>
    <link rel="stylesheet" href="style.css">
    <!-- App Config -->
    <script src="config.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <!-- Firebase Config (create this file from firebase-config.js.example) -->
    <script src="firebase-config.js" onerror="console.log('Firebase config not found - using localStorage')"></script>
    <script src="firebase-init.js"></script>
</head>
<body>
    <!-- Password Protection Modal -->
    <div id="passwordModal" class="modal" style="display: block; z-index: 10000;">
        <div class="modal-content" style="max-width: 400px;">
            <h2 style="margin-bottom: 20px;">üîí Password Required</h2>
            <p style="margin-bottom: 15px; color: #666;">Enter the password to access the Lab Moving Schedule</p>
            <form id="passwordForm">
                <div class="form-group">
                    <label for="passwordInput">Password</label>
                    <input type="password" id="passwordInput" required autofocus style="width: 100%; padding: 12px; font-size: 16px;">
                </div>
                <div id="passwordError" style="color: #dc3545; margin-bottom: 15px; display: none;">Incorrect password. Please try again.</div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Enter</button>
                </div>
            </form>
        </div>
    </div>

    <div class="container" id="mainApp" style="display: none;">
        <header>
            <div class="header-content">
                <img src="New logo.png" alt="Logo" class="logo">
                <div class="header-text">
                    <h1>üè¢ Lab Moving Schedule</h1>
                    <p class="subtitle">Track your lab migration tasks and timeline</p>
                </div>
            </div>
            <div id="syncStatus" style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                <span id="syncIndicator">üîÑ Connecting...</span>
            </div>
        </header>

        <div class="controls">
            <button id="addTaskBtn" class="btn btn-primary">+ Add New Task</button>
            <button id="exportBtn" class="btn btn-secondary">Export to Excel</button>
            <button id="settingsBtn" class="btn btn-secondary">‚öôÔ∏è Settings</button>
            <button id="planBtn" class="btn btn-secondary">üìã Plan</button>
        </div>

        <div class="timeline-wrapper">
            <div class="scroll-controls">
                <button id="scrollLeftBtn" class="scroll-btn">‚óÄ</button>
                <button id="scrollRightBtn" class="scroll-btn">‚ñ∂</button>
            </div>
            <div class="timeline-container" id="timelineContainer">
                <div class="timeline-header">
                    <div class="task-info-header">Task Details</div>
                    <div class="weeks-header" id="weeksHeader">
                        <!-- Weeks will be dynamically added here -->
                    </div>
                </div>

                <div id="tasksContainer" class="tasks-container">
                    <!-- Tasks will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeSettings">&times;</span>
            <h2>‚öôÔ∏è Settings</h2>
            <form id="settingsForm">
                <div class="form-group">
                    <label for="startWeekRange">Start Week</label>
                    <input type="number" id="startWeekRange" min="1" max="52" value="27" required>
                </div>
                <div class="form-group">
                    <label for="endWeekRange">End Week</label>
                    <input type="number" id="endWeekRange" min="1" max="52" value="52" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelSettingsBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Plan Modal -->
    <div id="planModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" id="closePlan">&times;</span>
            <h2>üìã Plan</h2>
            <div style="margin-top: 20px;">
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                    <strong>Lab team deals with high end and unique equipment (Scope, BERT, AWG, etc ...)</strong>
                </div>
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #50C878;">
                    <strong>Soldering technician ready on WW33</strong>
                </div>
                <div style="margin-top: 30px; padding: 15px; background: #fff3cd; border-radius: 8px;">
                    <strong>14 weeks of transition and 9 weeks of PO preparations to transfer and enable the new lab</strong>
                </div>
            </div>
            <div class="form-actions" style="margin-top: 20px;">
                <button type="button" class="btn btn-primary" id="closePlanBtn">Close</button>
            </div>
        </div>
    </div>

    <!-- Quick Edit Cell Modal -->
    <div id="cellEditModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close" id="closeCellEdit">&times;</span>
            <h2>Edit Week Cell</h2>
            <form id="cellEditForm">
                <div class="form-group">
                    <label for="cellDependencies">Dependencies</label>
                    <textarea id="cellDependencies" rows="3" placeholder="e.g., Need Rigotek, One rack per 2 working days"></textarea>
                </div>
                <div class="form-group">
                    <label for="cellFinishBefore">Task should finish before week</label>
                    <input type="number" id="cellFinishBefore" min="27" max="52" placeholder="Optional">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCellEditBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle">Add New Task</h2>
            <form id="taskForm">
                <div class="form-group">
                    <label for="taskName">Task Name *</label>
                    <input type="text" id="taskName" required>
                </div>
                <div class="form-group">
                    <label for="dependencies">Dependencies</label>
                    <textarea id="dependencies" rows="2" placeholder="e.g., Need Rigotek, One rack per 2 working days"></textarea>
                </div>
                <div class="form-group">
                    <label for="finishBefore">Must Finish Before Week</label>
                    <input type="number" id="finishBefore" min="27" max="52" placeholder="Optional">
                </div>
                <div class="form-group">
                    <label for="startWeek">Start Week *</label>
                    <input type="number" id="startWeek" min="27" max="52" required>
                </div>
                <div class="form-group">
                    <label for="duration">Duration (weeks) *</label>
                    <input type="number" id="duration" min="1" max="15" value="1" required>
                </div>
                <div class="form-group">
                    <label for="taskColor">Color</label>
                    <input type="color" id="taskColor" value="#4A90E2">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Task</button>
                    <button type="button" class="btn btn-danger" id="deleteBtn" style="display: none;">Delete</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

